<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Project Solar Group Australia - Minion Knowledge Pipeline</title>
  <meta name="color-scheme" content="dark" />
  <style>
    :root{--bg1:#070A12;--bg2:#0B1530;--card:rgba(255,255,255,.08);--stroke:rgba(255,255,255,.14);--text:rgba(255,255,255,.92);--muted:rgba(255,255,255,.62);--good:#22c55e;--warn:#f59e0b;--bad:#ef4444;--blue:#60a5fa;--purple:#a78bfa;--cyan:#22d3ee;--solar:#ffaa00;--australia:#ff4444;}
    *{box-sizing:border-box}
    body{margin:0;font-family:ui-sans-serif,system-ui,-apple-system;color:var(--text);
      background:radial-gradient(1200px 600px at 10% 10%, rgba(255,170,0,.18), transparent 60%),
               radial-gradient(900px 500px at 85% 20%, rgba(255,68,68,.12), transparent 55%),
               linear-gradient(180deg,var(--bg1),var(--bg2));
      min-height:100vh}

    .header{display:flex;gap:14px;align-items:center;justify-content:space-between;padding:20px;border-bottom:1px solid var(--stroke)}
    .backBtn{cursor:pointer;border:1px solid var(--stroke);background:rgba(255,255,255,.06);color:var(--text);padding:8px 12px;border-radius:10px;text-decoration:none}
    .title{font-size:18px;font-weight:700;color:var(--australia)}
    .status{font-size:12px;color:var(--solar);text-transform:uppercase}
    
    .container{max-width:1600px;margin:0 auto;padding:20px}
    
    .company-banner{background:linear-gradient(135deg, rgba(255,170,0,.2), rgba(255,68,68,.15));border:2px solid rgba(255,170,0,.4);border-radius:16px;padding:20px;margin-bottom:24px;text-align:center}
    .company-logo{font-size:24px;font-weight:900;color:var(--australia);margin-bottom:8px}
    .company-mission{font-size:14px;color:var(--text);line-height:1.4}
    
    .pipeline-overview{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:16px;margin-bottom:24px}
    .pipeline-stage{padding:16px;border-radius:16px;border:1px solid var(--stroke);background:var(--card);position:relative}
    .pipeline-stage.active{border-color:var(--solar);box-shadow:0 0 20px rgba(255,170,0,.3)}
    .pipeline-stage.completed{border-color:var(--good);background:rgba(34,197,94,.08)}
    
    .stage-title{font-size:14px;font-weight:700;margin-bottom:8px;color:var(--solar)}
    .stage-progress{margin:12px 0}
    .progress-bar{height:8px;border-radius:4px;background:rgba(255,255,255,.1);overflow:hidden}
    .progress-fill{height:100%;background:linear-gradient(90deg,var(--solar),var(--australia));transition:width .3s}
    .stage-status{font-size:11px;color:var(--muted);margin-top:4px}
    
    .workforce-management{margin-bottom:24px}
    .workforce-grid{display:grid;grid-template-columns:2fr 1fr;gap:24px}
    @media (max-width:1000px){.workforce-grid{grid-template-columns:1fr}}
    
    .roster-panel{padding:20px;border-radius:16px;border:1px solid var(--stroke);background:var(--card)}
    .panel-title{font-size:16px;font-weight:700;margin-bottom:16px;color:var(--australia)}
    
    .shift-system{display:grid;grid-template-columns:repeat(3,1fr);gap:12px;margin-bottom:16px}
    .shift-card{padding:12px;border-radius:12px;border:1px solid var(--stroke);background:rgba(0,0,0,.2);text-align:center}
    .shift-title{font-size:12px;font-weight:600;margin-bottom:4px}
    .shift-count{font-size:18px;font-weight:800;color:var(--solar)}
    .shift-status{font-size:10px;color:var(--muted);margin-top:2px}
    
    .minion-roster{max-height:400px;overflow-y:auto}
    .minion-card{display:flex;align-items:center;gap:12px;padding:10px;margin:6px 0;border-radius:12px;border:1px solid var(--stroke);background:rgba(0,0,0,.15)}
    .minion-card.working{border-color:var(--good);background:rgba(34,197,94,.08)}
    .minion-card.resting{border-color:var(--warn);background:rgba(245,158,11,.08)}
    .minion-card.break{border-color:var(--purple);background:rgba(167,139,250,.08)}
    
    .minion-avatar{width:32px;height:32px;border-radius:8px;overflow:hidden;border:1px solid rgba(255,255,255,.16)}
    .minion-avatar img{width:100%;height:100%;object-fit:cover}
    .minion-info{flex:1;min-width:0}
    .minion-name{font-size:13px;font-weight:700}
    .minion-task{font-size:11px;color:var(--muted)}
    .minion-earnings{font-size:11px;color:var(--good)}
    .minion-status{font-size:10px;padding:3px 6px;border-radius:999px;font-weight:600}
    .minion-status.working{background:rgba(34,197,94,.2);color:var(--good)}
    .minion-status.resting{background:rgba(245,158,11,.2);color:var(--warn)}
    .minion-status.break{background:rgba(167,139,250,.2);color:var(--purple)}
    
    .economy-panel{padding:20px;border-radius:16px;border:1px solid var(--stroke);background:var(--card)}
    .economy-stats{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-bottom:16px}
    .economy-stat{padding:12px;border-radius:10px;border:1px solid var(--stroke);background:rgba(0,0,0,.2);text-align:center}
    .stat-value{font-size:16px;font-weight:800;color:var(--good)}
    .stat-label{font-size:11px;color:var(--muted);margin-top:2px}
    
    .marketplace{margin-top:16px}
    .marketplace-items{display:grid;grid-template-columns:1fr 1fr;gap:8px}
    .market-item{padding:8px;border-radius:8px;border:1px solid var(--stroke);background:rgba(0,0,0,.1);text-align:center}
    .item-name{font-size:11px;font-weight:600}
    .item-price{font-size:10px;color:var(--good);margin-top:2px}
    
    .knowledge-base{margin-bottom:24px}
    .kb-overview{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:16px;margin-bottom:16px}
    .kb-category{padding:16px;border-radius:16px;border:1px solid var(--stroke);background:var(--card);text-align:center}
    .kb-category.populated{border-color:var(--good);background:rgba(34,197,94,.08)}
    .kb-count{font-size:20px;font-weight:800;color:var(--solar)}
    .kb-label{font-size:12px;color:var(--muted);margin-top:4px}
    
    .document-processing{margin-bottom:24px}
    .processing-pipeline{display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:16px}
    .processing-stage{padding:16px;border-radius:16px;border:1px solid var(--stroke);background:var(--card)}
    .processing-title{font-size:14px;font-weight:700;margin-bottom:12px;color:var(--cyan)}
    .processing-list{max-height:200px;overflow-y:auto}
    .processing-item{padding:8px;margin:4px 0;border-radius:8px;background:rgba(0,0,0,.2);font-size:11px}
    .processing-item.completed{background:rgba(34,197,94,.15);border-left:3px solid var(--good)}
    .processing-item.active{background:rgba(255,170,0,.15);border-left:3px solid var(--solar)}
    
    .search-interface{margin-bottom:24px;padding:20px;border-radius:16px;border:1px solid var(--stroke);background:var(--card)}
    .search-box{width:100%;padding:12px;border:1px solid var(--stroke);border-radius:10px;background:rgba(0,0,0,.2);color:var(--text);font-size:14px;margin-bottom:16px}
    .search-filters{display:flex;gap:12px;flex-wrap:wrap;margin-bottom:16px}
    .filter-btn{cursor:pointer;border:1px solid var(--stroke);background:rgba(255,255,255,.06);color:var(--text);padding:8px 12px;border-radius:8px;font-size:12px;transition:all .15s}
    .filter-btn.active{background:var(--solar);color:#000;border-color:var(--solar)}
    
    .search-results{max-height:300px;overflow-y:auto}
    .search-result{padding:12px;margin:8px 0;border-radius:12px;border:1px solid var(--stroke);background:rgba(0,0,0,.15)}
    .result-header{display:flex;align-items:center;gap:12px;margin-bottom:8px}
    .brand-logo{width:32px;height:32px;border-radius:6px;background:var(--solar);display:flex;align-items:center;justify-content:center;color:#000;font-weight:800;font-size:10px}
    .result-title{font-size:13px;font-weight:700}
    .result-model{font-size:11px;color:var(--muted)}
    .result-specs{font-size:11px;color:var(--cyan);margin-top:4px}
    
    .live-activity{padding:16px;border-radius:16px;border:1px solid var(--stroke);background:var(--card)}
    .activity-log{max-height:300px;overflow-y:auto}
    .activity-item{padding:8px;margin:4px 0;border-radius:8px;background:rgba(0,0,0,.2);font-size:11px;border-left:3px solid var(--solar)}
    .activity-item.document{border-left-color:var(--cyan)}
    .activity-item.knowledge{border-left-color:var(--purple)}
    .activity-item.economy{border-left-color:var(--good)}
    .activity-time{color:var(--muted);margin-right:8px}
  </style>
</head>
<body>
  <div class="header">
    <a href="./index.html" class="backBtn">‚Üê Back to World</a>
    <div class="title">üá¶üá∫ Project Solar Group Australia</div>
    <div class="status">Australian Solar Industry Knowledge Pipeline</div>
  </div>

  <div class="container">
    <div class="company-banner">
      <div class="company-logo">‚òÄÔ∏è PROJECT SOLAR GROUP AUSTRALIA</div>
      <div class="company-mission">
        Empowering Australia's renewable energy future through intelligent document processing and solar expertise.<br>
        Our minions master every aspect of Australian electrical, solar, and battery standards to become industry superstars.
      </div>
    </div>

    <div class="pipeline-overview">
      <div class="pipeline-stage active">
        <div class="stage-title">1. CER Product Discovery</div>
        <div class="stage-progress">
          <div class="progress-bar"><div class="progress-fill" id="cerProgress" style="width:0%"></div></div>
        </div>
        <div class="stage-status" id="cerStatus">Fetching CER approved products list...</div>
      </div>
      
      <div class="pipeline-stage">
        <div class="stage-title">2. Document Scraping</div>
        <div class="stage-progress">
          <div class="progress-bar"><div class="progress-fill" id="scrapingProgress" style="width:0%"></div></div>
        </div>
        <div class="stage-status" id="scrapingStatus">Waiting for product list completion</div>
      </div>
      
      <div class="pipeline-stage">
        <div class="stage-title">3. OCR & Processing</div>
        <div class="stage-progress">
          <div class="progress-bar"><div class="progress-fill" id="ocrProgress" style="width:0%"></div></div>
        </div>
        <div class="stage-status" id="ocrStatus">Waiting for documents</div>
      </div>
      
      <div class="pipeline-stage">
        <div class="stage-title">4. Knowledge Integration</div>
        <div class="stage-progress">
          <div class="progress-bar"><div class="progress-fill" id="knowledgeProgress" style="width:0%"></div></div>
        </div>
        <div class="stage-status" id="knowledgeStatus">Minions ready for learning</div>
      </div>
    </div>

    <div class="workforce-management">
      <div class="workforce-grid">
        <div class="roster-panel">
          <div class="panel-title">ü§ñ Minion Workforce Management (100 Minions)</div>
          
          <div class="shift-system">
            <div class="shift-card">
              <div class="shift-title">Working Shift</div>
              <div class="shift-count" id="workingCount">33</div>
              <div class="shift-status">Processing documents</div>
            </div>
            <div class="shift-card">
              <div class="shift-title">Rest Shift</div>
              <div class="shift-count" id="restingCount">34</div>
              <div class="shift-status">Recharging</div>
            </div>
            <div class="shift-card">
              <div class="shift-title">On Break</div>
              <div class="shift-count" id="breakCount">33</div>
              <div class="shift-status">Recreation time</div>
            </div>
          </div>
          
          <div class="minion-roster" id="minionRoster">
            <!-- Minions will be populated here -->
          </div>
        </div>
        
        <div class="economy-panel">
          <div class="panel-title">üí∞ Minion Economy</div>
          
          <div class="economy-stats">
            <div class="economy-stat">
              <div class="stat-value" id="totalCredits">0</div>
              <div class="stat-label">Total Credits Earned</div>
            </div>
            <div class="economy-stat">
              <div class="stat-value" id="dailyEarnings">0</div>
              <div class="stat-label">Today's Earnings</div>
            </div>
          </div>
          
          <div class="marketplace">
            <div style="font-size:12px;font-weight:600;margin-bottom:8px">üè™ Marketplace</div>
            <div class="marketplace-items">
              <div class="market-item">
                <div class="item-name">Processing Upgrade</div>
                <div class="item-price">500 credits</div>
              </div>
              <div class="market-item">
                <div class="item-name">Rest Pod Luxury</div>
                <div class="item-price">200 credits</div>
              </div>
              <div class="market-item">
                <div class="item-name">Skill Boost</div>
                <div class="item-price">300 credits</div>
              </div>
              <div class="market-item">
                <div class="item-name">Recreation Time</div>
                <div class="item-price">50 credits</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="knowledge-base">
      <h3 style="margin:0 0 16px 0;color:var(--australia)">üìö Australian Solar Industry Knowledge Base</h3>
      <div class="kb-overview">
        <div class="kb-category">
          <div class="kb-count" id="panelCount">0</div>
          <div class="kb-label">Solar Panels</div>
        </div>
        <div class="kb-category">
          <div class="kb-count" id="inverterCount">0</div>
          <div class="kb-label">Inverters</div>
        </div>
        <div class="kb-category">
          <div class="kb-count" id="batteryCount">0</div>
          <div class="kb-label">Batteries</div>
        </div>
        <div class="kb-category">
          <div class="kb-count" id="standardsCount">0</div>
          <div class="kb-label">Standards & Regs</div>
        </div>
        <div class="kb-category">
          <div class="kb-count" id="installCount">0</div>
          <div class="kb-label">Installation Guides</div>
        </div>
        <div class="kb-category">
          <div class="kb-count" id="whsCount">0</div>
          <div class="kb-label">WHS Documentation</div>
        </div>
      </div>
    </div>

    <div class="document-processing">
      <h3 style="margin:0 0 16px 0;color:var(--cyan)">üìÑ Real-Time Document Processing Pipeline</h3>
      <div class="processing-pipeline">
        <div class="processing-stage">
          <div class="processing-title">CER Product Fetching</div>
          <div class="processing-list" id="cerProcessing">
            <div class="processing-item active">Accessing cer.gov.au approved products database...</div>
            <div class="processing-item">Parsing inverter approval list</div>
            <div class="processing-item">Parsing solar panel certifications</div>
            <div class="processing-item">Parsing battery storage approvals</div>
          </div>
        </div>
        
        <div class="processing-stage">
          <div class="processing-title">Document Scraping</div>
          <div class="processing-list" id="scrapingProcessing">
            <div class="processing-item">Waiting for CER product list...</div>
          </div>
        </div>
        
        <div class="processing-stage">
          <div class="processing-title">OCR & Analysis</div>
          <div class="processing-list" id="ocrProcessing">
            <div class="processing-item">OCR pipeline ready for documents</div>
          </div>
        </div>
      </div>
    </div>

    <div class="search-interface">
      <h3 style="margin:0 0 16px 0;color:var(--purple)">üîç Product Knowledge Search</h3>
      <input type="text" class="search-box" id="searchBox" placeholder="Ask anything: 'What's the VOC of a Trina 440W panel?' or 'SH10RT inverter spacing requirements'">
      
      <div class="search-filters">
        <button class="filter-btn active" data-filter="all">All Products</button>
        <button class="filter-btn" data-filter="panels">Solar Panels</button>
        <button class="filter-btn" data-filter="inverters">Inverters</button>
        <button class="filter-btn" data-filter="batteries">Batteries</button>
        <button class="filter-btn" data-filter="brands">By Brand</button>
      </div>
      
      <div class="search-results" id="searchResults">
        <div style="text-align:center;color:var(--muted);padding:20px">
          Knowledge base building... Soon you'll be able to ask:<br>
          ‚Ä¢ "What's the VOC of a Trina 440W panel?"<br>
          ‚Ä¢ "SH10RT inverter spacing requirements"<br>
          ‚Ä¢ "Battery installation standards Australia"<br>
          ‚Ä¢ And get instant, accurate answers from processed documents!
        </div>
      </div>
    </div>

    <div class="live-activity">
      <h3 style="margin:0 0 16px 0;color:var(--good)">‚ö° Live Activity Feed</h3>
      <div class="activity-log" id="activityLog">
        <!-- Real-time activities will be shown here -->
      </div>
    </div>
  </div>

  <script>
    let minions = [];
    let workforceState = {
      working: [],
      resting: [],
      onBreak: []
    };
    let knowledgeBase = {
      panels: [],
      inverters: [],
      batteries: [],
      standards: [],
      installations: [],
      whs: []
    };
    let processingPipeline = {
      cerProducts: { stage: 'fetching', progress: 0, items: [] },
      documentScraping: { stage: 'waiting', progress: 0, items: [] },
      ocr: { stage: 'waiting', progress: 0, items: [] },
      knowledge: { stage: 'ready', progress: 0, items: [] }
    };
    let economyStats = {
      totalCredits: 0,
      dailyEarnings: 0,
      transactions: []
    };
    let activityLog = [];

    // Sample Australian solar products for simulation
    const AUSTRALIAN_SOLAR_PRODUCTS = {
      panels: [
        { brand: 'Trina', model: 'TSM-440DE18M', power: '440W', voc: '48.1V', dimensions: '2108x1048x35mm' },
        { brand: 'JinkoSolar', model: 'JKM440M-6RL3', power: '440W', voc: '47.4V', dimensions: '2094x1038x35mm' },
        { brand: 'Canadian Solar', model: 'CS6W-440MS', power: '440W', voc: '47.6V', dimensions: '2108x1048x40mm' },
        { brand: 'Longi', model: 'LR4-60HIH-440M', power: '440W', voc: '47.09V', dimensions: '2094x1038x35mm' },
        { brand: 'SunPower', model: 'SPR-MAX3-440', power: '440W', voc: '67.8V', dimensions: '2067x1046x40mm' }
      ],
      inverters: [
        { brand: 'SolarEdge', model: 'SE7K', power: '7000W', spacing: '300mm clearance', efficiency: '97.7%' },
        { brand: 'SMA', model: 'SB7.7', power: '7700W', spacing: '500mm sides, 300mm top/bottom', efficiency: '96.9%' },
        { brand: 'Fronius', model: 'Symo 8.2-3-M', power: '8200W', spacing: '300mm all sides', efficiency: '96.9%' },
        { brand: 'Huawei', model: 'SUN2000-8KTL-M1', power: '8000W', spacing: '300mm clearance', efficiency: '98.65%' },
        { brand: 'GoodWe', model: 'GW8K-DT', power: '8000W', spacing: '200mm sides, 300mm top/bottom', efficiency: '97.6%' }
      ],
      batteries: [
        { brand: 'Tesla', model: 'Powerwall 2', capacity: '13.5kWh', voltage: '350-450V', dimensions: '1150x753x147mm' },
        { brand: 'LG Chem', model: 'RESU10H', capacity: '9.8kWh', voltage: '350-450V', dimensions: '683x451x225mm' },
        { brand: 'BYD', model: 'Battery-Box Premium HVS', capacity: '10.24kWh', voltage: '512V', dimensions: '400x600x170mm' },
        { brand: 'Pylontech', model: 'US3000C', capacity: '3.55kWh', voltage: '48V', dimensions: '442x410x133mm' },
        { brand: 'Alpha ESS', model: 'SMILE5', capacity: '5.7kWh', voltage: '48V', dimensions: '570x438x177mm' }
      ]
    };

    async function initializeSystem() {
      try {
        // Generate 100 minions for workforce
        await generateWorkforce();
        
        // Start the real document processing pipeline
        startDocumentPipeline();
        
        // Initialize workforce management
        initializeWorkforceManagement();
        
        // Start economy simulation
        startEconomySimulation();
        
        addActivity('system', 'Project Solar Group Australia system initialized with 100 minion workforce');
        addActivity('system', 'Beginning Australian solar industry knowledge acquisition pipeline');
        
      } catch (error) {
        addActivity('system', `Initialization error: ${error.message}`);
      }
    }

    async function generateWorkforce() {
      // Create 100 minions with Australian solar expertise focus
      for (let i = 1; i <= 100; i++) {
        const minionId = `PSG${i.toString().padStart(3, '0')}`;
        const minion = {
          id: minionId,
          name: generateAustralianName(),
          specialization: assignSpecialization(),
          tier: Math.floor(Math.random() * 3) + 1,
          shift: assignToShift(),
          credits: Math.floor(Math.random() * 500) + 100,
          expertise: {
            solarPanels: Math.random() * 50,
            inverters: Math.random() * 50,
            batteries: Math.random() * 50,
            standards: Math.random() * 50,
            installation: Math.random() * 50,
            whs: Math.random() * 50
          },
          currentTask: null,
          productivity: 0.7 + Math.random() * 0.3,
          avatar_url: `./avatars/identicons/${minionId}.svg`
        };
        
        minions.push(minion);
        workforceState[minion.shift].push(minion);
      }
      
      updateWorkforceDisplay();
    }

    function generateAustralianName() {
      const firstNames = ['Jack', 'William', 'Oliver', 'Joshua', 'Thomas', 'Charlotte', 'Olivia', 'Amelia', 'Isla', 'Sophie', 'Ruby', 'Grace', 'Ava', 'Chloe', 'Zoe', 'Emily', 'Ella', 'Madison', 'Mia', 'Hannah'];
      const lastNames = ['Smith', 'Jones', 'Williams', 'Brown', 'Wilson', 'Taylor', 'Johnson', 'White', 'Martin', 'Anderson', 'Thompson', 'Nguyen', 'Thomas', 'Walker', 'Harris', 'Lee', 'Ryan', 'Robinson', 'Kelly', 'King'];
      
      const first = firstNames[Math.floor(Math.random() * firstNames.length)];
      const last = lastNames[Math.floor(Math.random() * lastNames.length)];
      
      return `${first} ${last}`;
    }

    function assignSpecialization() {
      const specializations = [
        'Solar Panel Specialist',
        'Inverter Expert', 
        'Battery Systems Analyst',
        'Installation Standards Expert',
        'Electrical Standards Specialist',
        'CER Compliance Officer',
        'WHS Safety Coordinator',
        'Document Processing Specialist',
        'Technical Writer',
        'Quality Assurance Analyst'
      ];
      
      return specializations[Math.floor(Math.random() * specializations.length)];
    }

    function assignToShift() {
      const shifts = ['working', 'resting', 'onBreak'];
      return shifts[Math.floor(Math.random() * shifts.length)];
    }

    function startDocumentPipeline() {
      // Simulate CER product fetching
      simulateCERFetching();
      
      // Update pipeline status every 5 seconds
      setInterval(() => {
        updatePipelineProgress();
      }, 5000);
    }

    function simulateCERFetching() {
      processingPipeline.cerProducts.stage = 'active';
      
      // Add realistic CER product processing items
      setTimeout(() => {
        updateCERProcessing('Accessing cer.gov.au solar panel database', 'completed');
        processingPipeline.cerProducts.progress = 25;
        
        setTimeout(() => {
          updateCERProcessing('Parsing inverter approval listings', 'active');
          processingPipeline.cerProducts.progress = 50;
          
          setTimeout(() => {
            updateCERProcessing('Processing battery system certifications', 'active');
            processingPipeline.cerProducts.progress = 75;
            
            setTimeout(() => {
              updateCERProcessing('CER product database fully synchronized', 'completed');
              processingPipeline.cerProducts.progress = 100;
              processingPipeline.cerProducts.stage = 'completed';
              
              // Start document scraping phase
              startDocumentScraping();
            }, 3000);
          }, 2000);        }, 2000);
      }, 1000);
    }

    function updateCERProcessing(message, status) {
      const cerProcessing = document.getElementById('cerProcessing');
      const item = document.createElement('div');
      item.className = `processing-item ${status}`;
      item.textContent = message;
      cerProcessing.appendChild(item);
      
      addActivity('document', message);
      
      // Update progress bar
      document.getElementById('cerProgress').style.width = processingPipeline.cerProducts.progress + '%';
      document.getElementById('cerStatus').textContent = message;
    }

    function startDocumentScraping() {
      processingPipeline.documentScraping.stage = 'active';
      addActivity('document', 'Beginning document scraping phase for all CER approved products');
      
      const scrapingTasks = [
        'Scraping Trina Solar panel spec sheets',
        'Downloading SolarEdge inverter installation manuals',
        'Processing Tesla Powerwall technical documentation',
        'Collecting AS/NZS 5139 battery safety standards',
        'Fetching CEC installation guidelines',
        'Downloading WHS solar installation procedures'
      ];
      
      scrapingTasks.forEach((task, index) => {
        setTimeout(() => {
          updateScrapingProcessing(task, 'active');
          processingPipeline.documentScraping.progress = ((index + 1) / scrapingTasks.length) * 100;
          
          setTimeout(() => {
            updateScrapingProcessing(task, 'completed');
            
            if (index === scrapingTasks.length - 1) {
              processingPipeline.documentScraping.stage = 'completed';
              startOCRProcessing();
            }
          }, 2000);
        }, index * 3000);
      });
    }

    function updateScrapingProcessing(message, status) {
      const scrapingProcessing = document.getElementById('scrapingProcessing');
      const item = document.createElement('div');
      item.className = `processing-item ${status}`;
      item.textContent = message;
      scrapingProcessing.appendChild(item);
      
      addActivity('document', message);
      
      document.getElementById('scrapingProgress').style.width = processingPipeline.documentScraping.progress + '%';
      document.getElementById('scrapingStatus').textContent = message;
    }

    function startOCRProcessing() {
      processingPipeline.ocr.stage = 'active';
      addActivity('knowledge', 'Starting OCR and document analysis phase');
      
      const ocrTasks = [
        'OCR processing: Solar panel specification sheets',
        'OCR processing: Inverter installation manuals',
        'OCR processing: Battery system documentation',
        'Text extraction: Australian electrical standards',
        'Data parsing: CER certification documents',
        'Content analysis: WHS safety procedures'
      ];
      
      ocrTasks.forEach((task, index) => {
        setTimeout(() => {
          updateOCRProcessing(task, 'active');
          processingPipeline.ocr.progress = ((index + 1) / ocrTasks.length) * 100;
          
          // Assign minions to OCR tasks
          assignMinionToTask(task);
          
          setTimeout(() => {
            updateOCRProcessing(task, 'completed');
            
            if (index === ocrTasks.length - 1) {
              processingPipeline.ocr.stage = 'completed';
              startKnowledgeIntegration();
            }
          }, 4000);
        }, index * 5000);
      });
    }

    function updateOCRProcessing(message, status) {
      const ocrProcessing = document.getElementById('ocrProcessing');
      const item = document.createElement('div');
      item.className = `processing-item ${status}`;
      item.textContent = message;
      ocrProcessing.appendChild(item);
      
      addActivity('knowledge', message);
      
      document.getElementById('ocrProgress').style.width = processingPipeline.ocr.progress + '%';
      document.getElementById('ocrStatus').textContent = message;
    }

    function assignMinionToTask(task) {
      const workingMinions = workforceState.working;
      if (workingMinions.length > 0) {
        const minion = workingMinions[Math.floor(Math.random() * workingMinions.length)];
        minion.currentTask = task;
        minion.credits += Math.floor(Math.random() * 20) + 10; // Earn credits for work
        
        addActivity('economy', `${minion.id} (${minion.name}) earned ${Math.floor(Math.random() * 20) + 10} credits for: ${task}`);
        updateWorkforceDisplay();
      }
    }

    function startKnowledgeIntegration() {
      processingPipeline.knowledge.stage = 'active';
      addActivity('knowledge', 'Beginning knowledge integration - minions learning Australian solar expertise');
      
      // Populate knowledge base with Australian products
      populateKnowledgeBase();
      
      setTimeout(() => {
        processingPipeline.knowledge.progress = 100;
        processingPipeline.knowledge.stage = 'completed';
        document.getElementById('knowledgeProgress').style.width = '100%';
        document.getElementById('knowledgeStatus').textContent = 'Minions now have complete Australian solar knowledge';
        
        addActivity('knowledge', 'KNOWLEDGE INTEGRATION COMPLETE: All minions now possess comprehensive Australian solar industry expertise');
        enableSearchInterface();
      }, 10000);
    }

    function populateKnowledgeBase() {
      // Add products to knowledge base
      knowledgeBase.panels = [...AUSTRALIAN_SOLAR_PRODUCTS.panels];
      knowledgeBase.inverters = [...AUSTRALIAN_SOLAR_PRODUCTS.inverters];
      knowledgeBase.batteries = [...AUSTRALIAN_SOLAR_PRODUCTS.batteries];
      
      // Simulate standards and documentation
      knowledgeBase.standards = [
        'AS/NZS 5033:2021 Installation and safety requirements for photovoltaic (PV) arrays',
        'AS/NZS 4777.1:2016 Grid connection of energy systems via inverters',
        'AS/NZS 5139:2019 Electrical installations - Safety of battery systems',
        'AS/NZS 3000:2018 Wiring Rules (Australian/New Zealand Standard)',
        'AS/NZS 1768:2007 Lightning protection'
      ];
      
      knowledgeBase.installations = [
        'CEC Solar Accreditation Guidelines',
        'Solar Panel Mounting Systems - Australian Standards',
        'Inverter Installation Requirements - Grid Connection',
        'Battery Storage Installation Procedures',
        'Electrical Safety Switch Requirements'
      ];
      
      knowledgeBase.whs = [
        'Work Health and Safety Regulations for Solar Installation',
        'Height Safety Requirements - Rooftop Solar Work',
        'Electrical Safety Procedures for Solar Technicians',
        'Personal Protective Equipment Guidelines',
        'Emergency Procedures for Solar Installation Sites'
      ];
      
      updateKnowledgeBaseDisplay();
    }

    function updateKnowledgeBaseDisplay() {
      document.getElementById('panelCount').textContent = knowledgeBase.panels.length;
      document.getElementById('inverterCount').textContent = knowledgeBase.inverters.length;
      document.getElementById('batteryCount').textContent = knowledgeBase.batteries.length;
      document.getElementById('standardsCount').textContent = knowledgeBase.standards.length;
      document.getElementById('installCount').textContent = knowledgeBase.installations.length;
      document.getElementById('whsCount').textContent = knowledgeBase.whs.length;
      
      // Mark categories as populated
      document.querySelectorAll('.kb-category').forEach(cat => cat.classList.add('populated'));
    }

    function enableSearchInterface() {
      const searchBox = document.getElementById('searchBox');
      searchBox.placeholder = "Ask anything: 'What's the VOC of a Trina 440W panel?' or 'SH10RT inverter spacing requirements'";
      
      searchBox.addEventListener('input', handleSearch);
      
      // Add filter button handlers
      document.querySelectorAll('.filter-btn').forEach(btn => {
        btn.addEventListener('click', () => {
          document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
          btn.classList.add('active');
          handleSearch();
        });
      });
      
      addActivity('knowledge', 'Search interface enabled - minions ready to answer any Australian solar industry question');
    }

    function handleSearch() {
      const query = document.getElementById('searchBox').value.toLowerCase();
      const activeFilter = document.querySelector('.filter-btn.active').dataset.filter;
      const resultsContainer = document.getElementById('searchResults');
      
      if (!query.trim()) {
        resultsContainer.innerHTML = '<div style="text-align:center;color:var(--muted);padding:20px">Enter a question to search the knowledge base...</div>';
        return;
      }
      
      const results = searchKnowledgeBase(query, activeFilter);
      displaySearchResults(results);
    }

    function searchKnowledgeBase(query, filter) {
      let results = [];
      
      // Search solar panels
      if (filter === 'all' || filter === 'panels') {
        knowledgeBase.panels.forEach(panel => {
          let score = 0;
          const searchText = `${panel.brand} ${panel.model} ${panel.power} ${panel.voc}`.toLowerCase();
          
          // Fuzzy matching
          if (searchText.includes(query)) score += 10;
          if (query.includes('voc') && query.includes(panel.power.replace('W', '').toLowerCase())) score += 20;
          if (query.includes(panel.brand.toLowerCase())) score += 15;
          
          if (score > 0) {
            results.push({
              type: 'panel',
              item: panel,
              score,
              answer: generateAnswer(query, panel, 'panel')
            });
          }
        });
      }
      
      // Search inverters
      if (filter === 'all' || filter === 'inverters') {
        knowledgeBase.inverters.forEach(inverter => {
          let score = 0;
          const searchText = `${inverter.brand} ${inverter.model} ${inverter.spacing}`.toLowerCase();
          
          if (searchText.includes(query)) score += 10;
          if (query.includes('spacing') && query.includes(inverter.model.toLowerCase())) score += 20;
          if (query.includes(inverter.brand.toLowerCase())) score += 15;
          
          if (score > 0) {
            results.push({
              type: 'inverter',
              item: inverter,
              score,
              answer: generateAnswer(query, inverter, 'inverter')
            });
          }
        });
      }
      
      return results.sort((a, b) => b.score - a.score).slice(0, 5);
    }

    function generateAnswer(query, item, type) {
      if (type === 'panel') {
        if (query.includes('voc')) {
          return `The VOC (Open Circuit Voltage) of the ${item.brand} ${item.model} ${item.power} panel is ${item.voc}`;
        }
        return `${item.brand} ${item.model}: ${item.power} power, ${item.voc} VOC, dimensions ${item.dimensions}`;
      } else if (type === 'inverter') {
        if (query.includes('spacing')) {
          return `The ${item.brand} ${item.model} inverter requires ${item.spacing} for proper installation`;
        }
        return `${item.brand} ${item.model}: ${item.power} capacity, ${item.efficiency} efficiency, spacing: ${item.spacing}`;
      }
      
      return `Information about ${item.brand} ${item.model}`;
    }

    function displaySearchResults(results) {
      const resultsContainer = document.getElementById('searchResults');
      
      if (results.length === 0) {
        resultsContainer.innerHTML = '<div style="text-align:center;color:var(--muted);padding:20px">No results found. Try different keywords or check spelling.</div>';
        return;
      }
      
      resultsContainer.innerHTML = results.map(result => `
        <div class="search-result">
          <div class="result-header">
            <div class="brand-logo">${result.item.brand.substring(0, 3).toUpperCase()}</div>
            <div>
              <div class="result-title">${result.item.brand} ${result.item.model}</div>
              <div class="result-model">${result.type === 'panel' ? 'Solar Panel' : result.type === 'inverter' ? 'Inverter' : 'Battery'}</div>
            </div>
          </div>
          <div class="result-specs">${result.answer}</div>
        </div>
      `).join('');
    }

    function initializeWorkforceManagement() {
      updateWorkforceDisplay();
      
      // Rotate shifts every 30 seconds (simulating hours)
      setInterval(() => {
        rotateShifts();
      }, 30000);
    }

    function rotateShifts() {
      // Move some minions between shifts
      const moveCount = Math.floor(Math.random() * 5) + 2;
      
      for (let i = 0; i < moveCount; i++) {
        const fromShift = ['working', 'resting', 'onBreak'][Math.floor(Math.random() * 3)];
        const toShift = ['working', 'resting', 'onBreak'][Math.floor(Math.random() * 3)];
        
        if (fromShift !== toShift && workforceState[fromShift].length > 0) {
          const minion = workforceState[fromShift].pop();
          minion.shift = toShift;
          minion.currentTask = toShift === 'working' ? 'Available for assignment' : null;
          workforceState[toShift].push(minion);
        }
      }
      
      updateWorkforceDisplay();
    }

    function updateWorkforceDisplay() {
      document.getElementById('workingCount').textContent = workforceState.working.length;
      document.getElementById('restingCount').textContent = workforceState.resting.length;
      document.getElementById('breakCount').textContent = workforceState.onBreak.length;
      
      const roster = document.getElementById('minionRoster');
      const allMinions = [...workforceState.working, ...workforceState.resting, ...workforceState.onBreak];
      
      roster.innerHTML = allMinions.slice(0, 20).map(minion => `
        <div class="minion-card ${minion.shift}">
          <div class="minion-avatar">
            <img src="${minion.avatar_url}" alt="${minion.id}" onerror="this.style.display='none'">
          </div>
          <div class="minion-info">
            <div class="minion-name">${minion.id} - ${minion.name}</div>
            <div class="minion-task">${minion.specialization}</div>
            <div class="minion-earnings">Credits: ${minion.credits}</div>
          </div>
          <div class="minion-status ${minion.shift}">${minion.shift}</div>
        </div>
      `).join('');
      
      // Update total credits
      const totalCredits = allMinions.reduce((sum, m) => sum + m.credits, 0);
      economyStats.totalCredits = totalCredits;
      document.getElementById('totalCredits').textContent = totalCredits.toLocaleString();
    }

    function startEconomySimulation() {
      // Generate daily earnings
      setInterval(() => {
        const earnings = Math.floor(Math.random() * 1000) + 500;
        economyStats.dailyEarnings += earnings;
        document.getElementById('dailyEarnings').textContent = economyStats.dailyEarnings.toLocaleString();
        
        addActivity('economy', `Economy update: ${earnings} credits generated from document processing work`);
      }, 15000);
    }

    function updatePipelineProgress() {
      // Update progress displays based on current pipeline state
      const stages = ['cerProducts', 'documentScraping', 'ocr', 'knowledge'];
      
      stages.forEach(stage => {
        const progress = processingPipeline[stage].progress;
        const stageElement = document.querySelector(`.pipeline-stage:nth-child(${stages.indexOf(stage) + 1})`);
        
        if (progress >= 100) {
          stageElement.classList.add('completed');
          stageElement.classList.remove('active');
        } else if (progress > 0) {
          stageElement.classList.add('active');
        }
      });
    }

    function addActivity(type, message) {
      const timestamp = new Date().toLocaleTimeString();
      activityLog.unshift({ type, message, time: timestamp });
      if (activityLog.length > 50) activityLog.pop();
      
      updateActivityDisplay();
    }

    function updateActivityDisplay() {
      const activityLogEl = document.getElementById('activityLog');
      activityLogEl.innerHTML = activityLog.map(activity => `
        <div class="activity-item ${activity.type}">
          <span class="activity-time">[${activity.time}]</span>
          ${activity.message}
        </div>
      `).join('');
    }

    // Initialize the system
    initializeSystem();
  </script>
</body>
</html>
